
      deepdive.schema.keys {
        dd_delta_smoke : [person_id]
        dd_new_smoke : [person_id]
        dd_delta_cancer : [person_id]
        dd_new_cancer : [person_id]
      }

      deepdive.schema.variables {
        dd_new_smoke.label: Boolean
smoke.label: Boolean
cancer.label: Boolean
dd_delta_cancer.label: Boolean
dd_new_cancer.label: Boolean
dd_delta_smoke.label: Boolean
      }
    

          deepdive.extraction.extractors.init_dd_delta_friends {
            sql: """ DROP TABLE IF EXISTS dd_delta_friends CASCADE;
            CREATE TABLE
            dd_delta_friends(person_id bigint,
                friend_id bigint)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_delta_smoke {
            sql: """ DROP TABLE IF EXISTS dd_delta_smoke CASCADE;
            CREATE TABLE
            dd_delta_smoke(person_id bigint,
              id bigint,
              label boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_new_person_has_cancer {
            sql: """ DROP TABLE IF EXISTS dd_new_person_has_cancer CASCADE;
            CREATE TABLE
            dd_new_person_has_cancer(person_id bigint,
                        has_cancer boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_delta_person {
            sql: """ DROP TABLE IF EXISTS dd_delta_person CASCADE;
            CREATE TABLE
            dd_delta_person(person_id bigint,
               name text)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_new_person {
            sql: """ DROP TABLE IF EXISTS dd_new_person CASCADE;
            CREATE TABLE
            dd_new_person(person_id bigint,
             name text)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_delta_person_has_cancer {
            sql: """ DROP TABLE IF EXISTS dd_delta_person_has_cancer CASCADE;
            CREATE TABLE
            dd_delta_person_has_cancer(person_id bigint,
                          has_cancer boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_delta_cancer {
            sql: """ DROP TABLE IF EXISTS dd_delta_cancer CASCADE;
            CREATE TABLE
            dd_delta_cancer(person_id bigint,
               id bigint,
               label boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_delta_person_smokes {
            sql: """ DROP TABLE IF EXISTS dd_delta_person_smokes CASCADE;
            CREATE TABLE
            dd_delta_person_smokes(person_id bigint,
                      smokes boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_new_person_smokes {
            sql: """ DROP TABLE IF EXISTS dd_new_person_smokes CASCADE;
            CREATE TABLE
            dd_new_person_smokes(person_id bigint,
                    smokes boolean)
            """
            style: "sql_extractor"
          }

          deepdive.extraction.extractors.init_dd_new_friends {
            sql: """ DROP TABLE IF EXISTS dd_new_friends CASCADE;
            CREATE TABLE
            dd_new_friends(person_id bigint,
              friend_id bigint)
            """
            style: "sql_extractor"
          }

        deepdive.extraction.extractors.cleanup {
          sql: """
          TRUNCATE dd_delta_friends;
          TRUNCATE dd_delta_smoke;
          TRUNCATE dd_new_person_has_cancer;
          TRUNCATE dd_delta_person;
          TRUNCATE dd_new_person;
          TRUNCATE dd_delta_person_has_cancer;
          TRUNCATE dd_delta_cancer;
          TRUNCATE dd_delta_person_smokes;
          TRUNCATE dd_new_person_smokes;
          TRUNCATE dd_new_friends;
          """
          style: "sql_extractor"
        }

      deepdive.extraction.extractors.ext_dd_delta_smoke {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_delta_smoke"
	deepdive sql 'INSERT INTO dd_delta_smoke SELECT DISTINCT R0.person_id, 0 AS id, R0.smokes AS label
          FROM dd_delta_person_smokes R0
        
          '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_delta_smoke"
        style: "cmd_extractor"
          
          input_relations: [
            dd_delta_person_smokes
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_person_has_cancer {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_new_person_has_cancer"
	deepdive sql 'INSERT INTO dd_new_person_has_cancer SELECT R0.person_id, R0.has_cancer
FROM person_has_cancer R0
        
UNION ALL
SELECT R0.person_id, R0.has_cancer
FROM dd_delta_person_has_cancer R0
        '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_new_person_has_cancer"
        style: "cmd_extractor"
          
          input_relations: [
            person_has_cancer
            dd_delta_person_has_cancer
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_person {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_new_person"
	deepdive sql 'INSERT INTO dd_new_person SELECT R0.person_id, R0.name
FROM person R0
        
UNION ALL
SELECT R0.person_id, R0.name
FROM dd_delta_person R0
        '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_new_person"
        style: "cmd_extractor"
          
          input_relations: [
            person
            dd_delta_person
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_smoke {
        cmd: """

	deepdive create view dd_new_smoke as 'SELECT DISTINCT R0.person_id, id, label
          FROM smoke R0
        
          
UNION ALL
SELECT DISTINCT R0.person_id, id, label
          FROM dd_delta_smoke R0
        
          '
	
        """
          output_relation: "dd_new_smoke"
        style: "cmd_extractor"
          dependencies: [ "ext_dd_delta_smoke" ]
          input_relations: [
            smoke
            dd_delta_smoke
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_delta_cancer {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_delta_cancer"
	deepdive sql 'INSERT INTO dd_delta_cancer SELECT DISTINCT R0.person_id, 0 AS id, R0.has_cancer AS label
          FROM dd_delta_person_has_cancer R0
        
          '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_delta_cancer"
        style: "cmd_extractor"
          
          input_relations: [
            dd_delta_person_has_cancer
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_cancer {
        cmd: """

	deepdive create view dd_new_cancer as 'SELECT DISTINCT R0.person_id, id, label
          FROM cancer R0
        
          
UNION ALL
SELECT DISTINCT R0.person_id, id, label
          FROM dd_delta_cancer R0
        
          '
	
        """
          output_relation: "dd_new_cancer"
        style: "cmd_extractor"
          dependencies: [ "ext_dd_delta_cancer" ]
          input_relations: [
            cancer
            dd_delta_cancer
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_person_smokes {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_new_person_smokes"
	deepdive sql 'INSERT INTO dd_new_person_smokes SELECT R0.person_id, R0.smokes
FROM person_smokes R0
        
UNION ALL
SELECT R0.person_id, R0.smokes
FROM dd_delta_person_smokes R0
        '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_new_person_smokes"
        style: "cmd_extractor"
          
          input_relations: [
            person_smokes
            dd_delta_person_smokes
          ]
      }
    

      deepdive.extraction.extractors.ext_dd_new_friends {
        cmd: """

	# TODO use temporary table
	deepdive create table "dd_new_friends"
	deepdive sql 'INSERT INTO dd_new_friends SELECT R0.person_id, R0.friend_id
FROM friends R0
        
UNION ALL
SELECT R0.person_id, R0.friend_id
FROM dd_delta_friends R0
        '
	# TODO rename temporary table to replace output_relation
	
        """
          output_relation: "dd_new_friends"
        style: "cmd_extractor"
          
          input_relations: [
            friends
            dd_delta_friends
          ]
      }
    

        deepdive.inference.factors.dd_delta_inf_imply_smoke_cancer {
          input_query: """
          SELECT R0.id AS "dd_new_smoke.R0.id" , R1.id AS "dd_new_cancer.R1.id" 
          FROM dd_new_smoke R0, dd_new_cancer R1, dd_delta_person_smokes R2
        WHERE R1.person_id = R0.person_id  AND R2.person_id = R0.person_id """
          function: "Imply(dd_new_smoke.R0.label, dd_new_cancer.R1.label)"
          weight: "0.5"
          
          input_relations: [
            dd_new_smoke
            dd_new_cancer
            dd_delta_person_smokes
          ]
        }
      

        deepdive.inference.factors.dd_delta_inf_imply_smoke_smoke {
          input_query: """
          SELECT R0.id AS "dd_new_smoke.R0.id" , R1.id AS "dd_new_smoke.R1.id" 
          FROM dd_new_smoke R0, dd_new_smoke R1, dd_delta_friends R2
        WHERE R2.person_id = R0.person_id  AND R2.friend_id = R1.person_id """
          function: "Imply(dd_new_smoke.R0.label, dd_new_smoke.R1.label)"
          weight: "0.4"
          
          input_relations: [
            dd_new_smoke
            dd_delta_friends
          ]
        }
      
deepdive.pipeline.run: ${PIPELINE}
deepdive.pipeline.pipelines.extraction: [
  ext_dd_delta_cancer
  ext_dd_delta_smoke
  ext_dd_new_person_smokes
  ext_dd_new_person_has_cancer
  ext_dd_new_cancer
  ext_dd_new_person
  ext_dd_new_friends
  ext_dd_new_smoke
]
deepdive.pipeline.pipelines.inference: [
  dd_delta_inf_imply_smoke_cancer
  dd_delta_inf_imply_smoke_smoke
]
deepdive.pipeline.pipelines.endtoend: [
  ext_dd_delta_cancer
  ext_dd_delta_smoke
  ext_dd_new_person_smokes
  ext_dd_new_person_has_cancer
  ext_dd_new_cancer
  ext_dd_new_person
  ext_dd_new_friends
  ext_dd_new_smoke
  dd_delta_inf_imply_smoke_cancer
  dd_delta_inf_imply_smoke_smoke
]
deepdive.pipeline.base_dir: ${BASEDIR}
deepdive.pipeline.pipelines.initdb: [
  init_dd_delta_friends
  init_dd_delta_smoke
  init_dd_new_person_has_cancer
  init_dd_delta_person
  init_dd_new_person
  init_dd_delta_person_has_cancer
  init_dd_new_smoke
  init_dd_delta_cancer
  init_dd_new_cancer
  init_dd_delta_person_smokes
  init_dd_new_person_smokes
  init_dd_new_friends
]
deepdive.pipeline.pipelines.cleanup: [
  cleanup
]
